package com.codeskraps.y2020.days

import com.codeskraps.y2020.Main.DEBUG

class Day3 : Day() {

    override val day: String
        get() = "Three"

    override fun partOne(): String = findTreesForSlope(3, 1).toString()

    override fun partTwo(): String {
        val slopeOne = findTreesForSlope(1, 1)
        val slopeTwo = findTreesForSlope(3, 1)
        val slopeThree = findTreesForSlope(5, 1)
        val slopeFour = findTreesForSlope(7, 1)
        val slopeFive = findTreesForSlope(1, 2)

        return (slopeOne * slopeTwo * slopeThree * slopeFour * slopeFive).toString()
    }

    private fun findTreesForSlope(right: Int, down: Int): Int {
        var trees = 0
        var col = 0
        var index = 0

        debugPrintf("Slope right: %d - down: %d\n", right, down)
        val inputCopy = INPUT.copyOf()

        while (index < INPUT.size) {
            if (index != 0) {
                var row = inputCopy[index]
                col += right

                if (col >= row.length) {
                    INPUT.forEachIndexed { i, s -> inputCopy[i] += s }
                    row = inputCopy[index]
                }

                val copy = row.toCharArray()

                if (row[col] == TREE) {
                    copy[col] = HIT
                    trees++
                } else copy[col] = ROAD

                inputCopy[index] = String(copy)
            }

            index += down
        }

        if (DEBUG) inputCopy.forEach { debugPrintf("$it\n") }
        debugPrintf("%s", "\n")

        return trees
    }

    companion object {
        private const val TREE = '#'
        private const val HIT = 'X'
        private const val ROAD = 'O'

        private val INPUT = arrayOf(
                "....#...##.#.........#....#....",
                "#.......#...#...#.#............",
                "#..#..#.#.##....#.#........#...",
                "........##...................#.",
                "........#...##...#.#.###.......",
                "##............#...#.....#.##...",
                "...........#....###...#.....#..",
                ".......#......#..##..#.....#...",
                "..#.#..#....#.........#...#..#.",
                ".........##......#.....##..##..",
                "........#.....#....#..##......#",
                "..#..#.......#..............#..",
                ".....#.#.......................",
                ".#.#....#.........#............",
                ".......#.....#.###.............",
                "......##......#...........#..#.",
                ".#...............##...#........",
                ".....#..##........###.........#",
                "#...........#..#............#..",
                ".........#....#..#.#......#....",
                ".......#.........#..##.........",
                ".##.....#..................#...",
                "....#............#.#....#.....#",
                "..#....#...##....#...#.#...#...",
                "..........#................#.#.",
                "#...#.#.#.####..#.#..........#.",
                "..#...#.##......#...........#..",
                "..#.....#...#.......#......#..#",
                "..............#.......#........",
                ".#..#..........#.....#...#..#.#",
                "#........#...#......#.......#..",
                "#..................#...........",
                "..#...#........#...#..#........",
                "..............#.....#.....#..#.",
                "#.#.......#..............##.##.",
                "....#.#.....##....#...........#",
                "......#....#...#..#.......#....",
                "....#..#.#.....#..##.....#....#",
                "...........#.......#.#.#.......",
                "#.......#..##........#..#......",
                ".........#.##..#..............#",
                "...........#............###.#..",
                "..#.....#.....##...#.........#.",
                "....##............##........#..",
                ".....###..........#......##....",
                "#...##..#..#..........#........",
                "....#.....#.......#..#.#...##..",
                ".#....#........#.#.........#.#.",
                "##...#.#.....#......#..........",
                ".....##.....#....#.....###.#..#",
                "..............#..###..#...#..#.",
                "....#...#....#.............#.#.",
                ".#.........#.....#........#.##.",
                "....#.........#..........#.....",
                ".......#........#.#.#..........",
                "#........##....#.........#.....",
                "..##..........#....#.#...#....#",
                "#...#.#......#..##..........#.#",
                ".....#..#...#..#...............",
                "#...#..............#...........",
                ".#...#....#..##.....#....#.#...",
                ".#...#.......#...#..#.##....#..",
                "#....#........#....#...#.......",
                "#..#......#.....#.....#..##....",
                "......#.#....##....##..#...#...",
                "..#....#.#.###..............#..",
                ".#.##.......#.#.#..#...#..#....",
                "..#..........#.#....#..#.#....#",
                "..........#...#...#..........#.",
                "..........#.....#.#..#..#....##",
                ".#.#...##...#...........####...",
                "........##..#.#..........#.##.#",
                "#......###...........#...#.....",
                "..#.#....##.........##....#....",
                "#....#.##..##..#..#.....#.....#",
                ".##.....##....##....#.......#..",
                "#...#.....##....#..........#...",
                "............#.#.##....#....#...",
                "....#............#.....#......#",
                "....................#..........",
                "..#....................#..#....",
                "....#.....#........#..##...#...",
                "#.....#.#....................##",
                ".#....#.#.#...#..........#....#",
                "....#...#......#...#.....##...#",
                ".....#.........................",
                ".......#..#.#...#...#...#.....#",
                "...#......#.##.#...#..#...##.#.",
                "...........................#..#",
                "..#.#.....#........##..........",
                "....#...##........#.#.#..#...##",
                "..##.....#..###.........##.##..",
                ".#..#.....#...#.............#..",
                "#..............##...#....##....",
                ".##......#.#............#......",
                ".............##...#.#.......#..",
                ".........#..#..#...............",
                "........##......#....##........",
                "...#.........#.#.#.............",
                "#..........#......#......#..#..",
                ".............##.#.#..#.#.#...#.",
                ".....#.........#...............",
                "..##.#..#.....##..#........#.#.",
                ".#..........#.#.......#......##",
                ".#........................#....",
                "#....#....#...#..#......#......",
                "........#.......#......#.....#.",
                ".....#....##..#...###...#....#.",
                "....#.........#....#......#....",
                ".............#...#....#.......#",
                ".....#.........#..#.#..........",
                ".........#..#........#.#.#.....",
                "......#.##......#....#.#.##.#..",
                ".#...#.#...#...#.#......#....##",
                ".#................#......#.....",
                "#.#.#...............#..........",
                ".....#.#.......#...#........#..",
                "#...#.#.#.##..#...........#..#.",
                ".............###.........#....#",
                ".#.....#.......##....##.......#",
                "....#...#.......#.##.....#.....",
                "...........##.........#...#....",
                "..............#.#..#.....#..#..",
                "#.#...#..#.#.........#......#.#",
                "#.##.....##....#........#.#.#.#",
                "##.#.###.........##.......#..#.",
                "#.....#.....................#..",
                ".........##........#...........",
                ".###........##....#...#........",
                "....#.#........##...........#..",
                "..........#.....#..........#..#",
                "......#..............#......#..",
                ".....#...#......#...#...#......",
                "..........#.#..#....#...#..###.",
                "#..##........#................#",
                "..#............................",
                ".....#.........#.#.............",
                "........#...#.....#...##......#",
                "..#........#................#..",
                "......#....#..#......#.........",
                "...........##....#..#.#........",
                ".....#.............###.........",
                "#............#......#..#.......",
                "..#..#.................#..#..##",
                ".......#......#.....#........#.",
                "....................#..#.##...#",
                ".#..##...............##...#....",
                "...#...#....#........#.........",
                ".....##...#.....###............",
                ".###.........#........#.....##.",
                ".............#...#.............",
                "...#.#...............#..##..#.#",
                "...#...............#..#.....#..",
                "....#.#..................#...#.",
                "..........#...........#.#...###",
                "#...#......#................#..",
                "...#.#.......#...#......#.##...",
                "......#..........#.............",
                "##.......#.##.#...........#....",
                "......#...#.#.....#............",
                ".#.....#.....#.....#.........#.",
                "..................#............",
                ".#.#.#.....#......#.##.........",
                ".......#..##.##......#..#....#.",
                "...#.#.#......#...#........#...",
                "..#............#......#.......#",
                "..#......#........#.........#..",
                "..#..#.#.#.....#.............#.",
                "..#.#..##......#...#...##......",
                ".##...#....##.#.#...........#..",
                "..............#..#...#....#....",
                ".......#.#........#............",
                ".....##..###........#..........",
                "......................#........",
                "..##....#....#.................",
                ".##.#.###.#........#.##..#...#.",
                "##................#...........#",
                "....#..##.....##...............",
                ".#.....#..#............#.....#.",
                "#.........#..............#.....",
                "...##.#......#...#.............",
                "................#..............",
                "...#.....#....##...#..#....#...",
                "..............##..#...#.##..#..",
                "......................#..#....#",
                ".......#....#..#.##.........#.#",
                "#...#........##.......#........",
                "...##...............#.....#....",
                ".##...##...#...................",
                ".........##.#...#.........#....",
                "............#............#..#..",
                ".............................#.",
                "....#.#....#...................",
                "......#......#...#..##.........",
                "#........#.#.#.#.#......#....#.",
                ".#.........#.#...#......#..#.#.",
                "..............#....##.........#",
                ".#.......#..#....#.#.#....#....",
                "...###.#.#..#...#....#....#....",
                "#........#....................#",
                "......#...##.###..#..##...#....",
                ".....#........#.......#........",
                "#..#...........#.#.............",
                "....##.#...#..##............##.",
                "#.#..##..#...#...#.....#.......",
                "..#.............#.##..#...#.##.",
                ".#.....##.#..#...#...........#.",
                "....#...#....................##",
                "....##......#.###......#......#",
                "...#...#.........#..#.##....#..",
                "#......#..#....###.........#...",
                "#...........##.............#.#.",
                "#..............##....#......#..",
                ".........#...#.#...#...#.......",
                "....#....#............#.......#",
                "........#...#....#......##.....",
                "..........#.#..#.........#.....",
                "#........#.##....##......#.....",
                "...#.......#...................",
                "###...#...#..#.##....#.....#...",
                "........##..........#.##..#....",
                ".....#......#..#.....#.....#.#.",
                "...#..#..##..###.....##.#......",
                "#..#......##...#............#..",
                "#............#....#..#.........",
                "#........#.......#......#..##.#",
                "...#.#.........#.#.............",
                "#..............#..............#",
                "#.#......#..........##.........",
                "#..##...........#..##...#......",
                ".....#.#.....#......#.....#.#.#",
                ".#.##...#...##...........#....#",
                "#.............#........#.......",
                "..##.............#...#.........",
                "....#.#......###....#..........",
                "...#..#.....#..##.#....#...#.#.",
                ".............##................",
                "#.#............#........#..#.#.",
                ".#......#.....#...........#....",
                "...#.........#...........#.##..",
                ".....#...#.....#..#..........#.",
                "........#.#...............#.#..",
                ".......#..#..#.....#.......##..",
                ".#...#...#..#...##...#.........",
                "..........##....#..#.##..#.....",
                "....#.................#...#....",
                ".........#...#......#....#....#",
                ".........#..#...#.##........##.",
                "#.#....##.......#.#............",
                "##.......##..................#.",
                "......#...#......##............",
                "##.#...#.#...........#..#......",
                ".........#.........#..#.#...#..",
                ".#...#.......#.#...###.........",
                "................#.#.....#......",
                "..#...#.....#........#.........",
                ".........##.###.#.#.....#...#..",
                "#..#..........#....#.#...#...##",
                "##.#.#....#..##.............#.#",
                ".###....#..#...............##..",
                "............#......#.#.#....#..",
                "........#...#..#...#...........",
                "##.........#................#..",
                "...###...#.#..#...#..........##",
                "...#......#......##........#...",
                ".......#............#..........",
                ".....#.....##....#.....###.....",
                ".#...#...#.....#..#..#....#..#.",
                "#.#........#..#.......##...#.##",
                ".....#.....##..#.##........#..#",
                ".....#...#...........#.........",
                "..#....#.#...#..#....##...#...#",
                "...........#...##.........#....",
                "..#....#....##........#.####...",
                "#.............#.#.............#",
                "...................#.....#.#..#",
                ".#....#.#.............#.#......",
                "#...........#............#.#...",
                "..#.........#.#....#.......##..",
                "#....####......#...#......#....",
                "....##....#...................#",
                "....#.##....#.............#....",
                ".........##........#.....#..#..",
                "............#...#..............",
                "............#..##....#.....##.#",
                "............#.....#......#.....",
                "........#..#........##.#.......",
                "...#.#........#..............#.",
                "............#.........#..#.#...",
                "................#.............#",
                "..##..........##......#.#......",
                "..#..#.##....#.........#...#...",
                "...........##...#.#.#..........",
                ".#.#.......#.#...#.........#...",
                ".........#..#........#..#.#....",
                "..........##..#.##....#....#...",
                "....#...............#.......#..",
                "##..........##.................",
                "....#.#.#.....#..........##.#..",
                "..............#.##..........##.",
                "##...............#...#..#......",
                "..#..#..........#......#.......",
                "#...#..##.#.#..................",
                "....#....##......##.#...#....##",
                ".#...#.#....##.............#..#",
                "................#......###.....",
                "..#..#.............#.#.......#.",
                "..#..................#.......#.",
                ".....#.......#....#.##...#.##..",
                ".....##.......#......#..#......",
                "#..#.......#........#..........",
                "..#...#..#....#.........#......",
                "#..#..#......##..#.##....####..",
                "......##.#.....#..#.......#....",
                ".##...#.....#..#...#.#.........",
                "#.....#........###....#...#..#.",
                ".#....#.#..#......#............",
                ".........#..#..#.....#........#",
                "..#.......#..........#..#......",
                "......#.......##.#....#.#.#....",
                ".#............#.....#.......#..",
                "...#..#...............#........",
                ".....#........................."
        )
    }
}